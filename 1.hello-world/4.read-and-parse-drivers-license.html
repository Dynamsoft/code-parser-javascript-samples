<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF417 Driver License</title>
  <script src="https://cdn.jsdelivr.net/npm/shen-dynamsoft-code-parser@0.20220712174000.0/dist/dcp.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dynamsoft-javascript-barcode@9.0.2/dist/dbr.js"></script>
</head>
<body>
  <div>Loading...</div>
  <script>
    Dynamsoft.DCP.CodeParser.licenseServer = "https://mtpl.dynamsoft.com";
    /** LICENSE ALERT - README 
      * DBR
      * To use the library, you need to first specify a license key using the API "license" as shown below.
    */
    // Dynamsoft.DBR.BarcodeReader.license = "DLS2eyJvcmdhbml6YXRpb25JRCI6IjIwMDAwMSJ9";
    Dynamsoft.DBR.BarcodeReader.license = "t0068MgAAAHAj08AlvDnydcHJcGK6l7PVDrsXtab/Y95htQV2l4wARVGHk1FG1ZP9SDFUwLvmo0ez18WZYgTLPbLSWwJ1V60=";
    /** 
      * You can visit https://www.dynamsoft.com/customer/license/trialLicense?utm_source=github&product=dbr&package=js to get your own trial license good for 30 days. 
      * Note that if you downloaded this sample from Dynamsoft while logged in, the above license key may already be your own 30-day trial license.
      * For more information, see https://www.dynamsoft.com/barcode-reader/programming/javascript/user-guide/?ver=9.0.2&utm_source=github#specify-the-license or contact support@dynamsoft.com.
      * LICENSE ALERT - THE END 
    */

    
    /** LICENSE ALERT - README 
      * DCP 
      * To use the library, you need to first specify a license key using the API "license" as shown below.
    */
    Dynamsoft.DCP.CodeParser.license = "DLS2eyJoYW5kc2hha2VDb2RlIjoiMjM0ODEwLVRYbFhaV0pRY205cVgyUmpjQSIsIm9yZ2FuaXphdGlvbklEIjoiMjM0ODEwIn0=";
    /** 
      * You can contact Dynamsoft Support Team (https://www.dynamsoft.com/Company/Contact.aspx) to obtain a license.
      * LICENSE ALERT - THE END 
    */
    (async() => {
      try {
        // Create a DBR instance and set it to decode only PDF417
        const scanner = await Dynamsoft.DBR.BarcodeScanner.createInstance();
        const settings = await scanner.getRuntimeSettings();
        settings.deblurLevel = 7;
        settings.barcodeFormatIds = 0;
        settings.barcodeFormatIds_2 = 0;
        settings.barcodeFormatIds |= Dynamsoft.DBR.EnumBarcodeFormat.BF_PDF417;
        settings.barcodeFormatIds |= Dynamsoft.DBR.EnumBarcodeFormat.BF_QR_CODE;
        await scanner.updateRuntimeSettings(settings);
        // Create a DCP instance
        const parser = await Dynamsoft.DCP.CodeParser.createInstance();
        
        // Set the parsing format
        await parser.setCodeFormat(Dynamsoft.DCP.EnumCodeFormat.CF_AUTO);

        scanner.onUniqueRead = async (txt, result) => {
          // Data is parsed through DCP
          const info = await parser.parseData(result.barcodeBytes);
          alert(JSON.stringify(info));
          console.log(info);
        }

        await scanner.show();
        
      } catch(ex) {
        alert(ex);
      }
    })();
  </script>
</body>
</html>